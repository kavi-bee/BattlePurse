<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Zone - Live Tournaments</title>
<style>
/* Premium page loader overlay (smaller + cleaner) */
/* Premium page loader overlay (smaller + cleaner) */
.page-loader {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #010101, #0b0b0b, #111);
    animation: bgMove 7s infinite alternate ease-in-out;
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
}

/* Background animation */
@keyframes bgMove {
    0% { background-position: 0 0; }
    100% { background-position: 180% 180%; }
}

.page-loader .loader-box {
    text-align: center;
    animation: fadeIn 0.9s ease-out forwards;
}

/* Smaller logo */
.page-loader-logo {
    width: 55px;
    border-radius: 14px;
    box-shadow: 0 0 14px rgba(0,255,255,0.32);
    position: relative;
}

/* Shine effect (scaled down) */
.page-loader .shine {
    position: absolute;
    top: 0;
    left: -90px;
    width: 90px;
    height: 100%;
    background: linear-gradient(120deg, transparent, rgba(255,255,255,0.35), transparent);
    transform: skewX(-20deg);
    animation: shineMove 2s infinite;
}

@keyframes shineMove {
    0% { left: -90px; }
    100% { left: 120px; }
}

/* Smaller app title */
.page-loader-title {
    font-size: 16px;
    color: #00eaff;
    margin-top: 8px;
    letter-spacing: 0.8px;
    animation: glowPulse 2s infinite ease-in-out;
    text-shadow: 0 0 7px rgba(0,255,255,0.45);
}

@keyframes glowPulse {
    0%, 100% { text-shadow: 0 0 6px #00eaff; }
    50% { text-shadow: 0 0 12px #00eaff; }
}

/* Slimmer loading bar (smaller) */
.loader-bar {
    width: 115px;
    height: 4px;
    background: rgba(255,255,255,0.07);
    margin: 12px auto 0;
    border-radius: 50px;
    overflow: hidden;
    position: relative;
}

/* Smaller liquid animation */
.loader-liquid {
    width: 40px;
    height: 100%;
    border-radius: 50px;
    background: linear-gradient(90deg, #00eaff, #14ffec, #00b7ff);
    position: absolute;
    left: -45px;
    animation: slideLiquid 1.4s infinite ease-in-out;
}

@keyframes slideLiquid {
    0% { left: -45px; }
    100% { left: 140px; }
}

/* Fade out */
.hide-loader {
    opacity: 0;
    transition: opacity 0.55s ease;
    pointer-events: none;
}


* { margin: 0; padding: 0; box-sizing: border-box; }
body { background: #0a0a0a; color: #fff; font-family: 'Poppins', sans-serif; padding-bottom: 80px; }

/* Navbar */
nav { position: fixed; top: 0; left: 0; width: 100%; background: #111; padding: 12px 20px; display: flex; justify-content: space-between; align-items: center; z-index: 1000; box-shadow: 0 2px 5px rgba(0,0,0,0.6); }
nav h1 { color: #00faff; font-size: 1.5rem; }

/* Promo Bar */
.promo-bar { position: fixed; top: 54px; left: 0; width: 100%; height: 90px; background: #111; display: flex; align-items: center; overflow: hidden; z-index: 999; }
.promo-track { display: flex; animation: scrollPromo 30s linear infinite; }
.promo-item { flex: 0 0 auto; margin: 0 20px; text-align: center; }
.promo-item img { width: 130px; height: 70px; object-fit: cover; border-radius: 10px; box-shadow: 0 0 8px #00faff70; }
@keyframes scrollPromo { from { transform: translateX(0); } to { transform: translateX(-50%); } }



/* Content */
.content, #promosContainer, #winningInfo { margin-top: 180px; padding: 20px; }
#filters { text-align: center; margin-bottom: 15px; }
#filters input, #filters select, #filters button { margin: 5px; padding: 6px; border-radius: 5px; border: none; cursor: pointer; }

.game-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; }
.game-card { background: #1c1c1c; padding: 10px; border-radius: 10px; text-align: center; box-shadow: 0 0 10px #00faff40; }
.game-card img { width: 100%; border-radius: 10px; }
.game-card h3 { color: #ae00ff; margin: 10px 0 5px; }
.game-card p { font-size: 0.9rem; margin: 3px 0; }
.game-card button { background: #ae00ff; color: #fff; border: none; padding: 6px; border-radius: 5px; cursor: pointer; margin: 3px; }
#status { text-align: center; color: #9ff; margin-top: 10px; }

/* Latest Promos */
#promosContainer { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin-left: 20px; }
.latest-promo { background: #1c1c1c; padding: 3px; border-radius: 8px; text-align: center; width: 85px; box-shadow: 0 0 5px #00faff40; transition: transform 0.2s ease; }
.latest-promo img { width: 100%; height: 55px; border-radius: 6px; object-fit: cover; }
.latest-promo:hover { transform: scale(1.05); }

.podium { display: flex; justify-content: center; align-items: flex-end; gap: 20px; margin-top: 20px; text-align: center; }
.podium-spot { background: #111; border-radius: 15px; padding: 15px; width: 160px; box-shadow: 0 0 10px #00faff44; transition: transform 0.3s; }
.podium-spot:hover { transform: translateY(-5px); }
.podium-spot img { width: 80px; height: 80px; border-radius: 50%; border: 3px solid #00faff; margin-bottom: 10px; }
.podium-1 { transform: translateY(-20px); }
.podium-2 { transform: translateY(-10px); }
.podium-3 { transform: translateY(0px); }

#walletBalance { text-align: center; margin-bottom: 25px; color: #00faff; font-weight: bold; }
.mode-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px; }
.mode-card { background: #121212; border-radius: 15px; padding: 20px; text-align: center; transition: transform 0.3s, box-shadow 0.3s; cursor: pointer; }
.mode-card:hover { transform: scale(1.05); box-shadow: 0 0 15px #00faff44; }
.mode-card h3 { color: #00faff; margin-bottom: 10px; }
.section { display: none; margin-top: 20px; text-align: center; }
.section.active { display: block; }

label { display: block; margin: 10px auto; width: 80%; text-align: left; }
select, input { width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #00faff66; background: #121212; color: #fff; margin-top: 5px; }
button { padding: 10px 20px; border: none; border-radius: 8px; background: #00faff22; color: #00faff; cursor: pointer; margin: 10px; }
button:hover { background: #00faff44; }

.primary { background: #00d5ff; color: #000; border: none; padding: 10px 14px; border-radius: 8px; cursor: pointer; }
.muted { background: #222; color: #aaa; border: none; padding: 8px 12px; border-radius: 8px; }

.message { margin-top: 15px; font-weight: bold; color: #00faff; white-space: pre-line; }

/* Live Winnings */
#winningInfo { margin: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
.win-card { background: #1c1c1c; padding: 10px; border-radius: 10px; box-shadow: 0 0 10px #00faff40; text-align: center; }
.win-card h4 { color: #00faff; margin-bottom: 5px; }
.win-card p { font-size: 0.85rem; margin: 2px 0; }

/* Bottom Nav */
.sidebar { position: fixed; bottom: 0; left: 0; width: 100%; background: #111; display: flex; justify-content: space-around; padding: 8px 0; border-top: 1px solid #222; z-index: 1000; }
.nav-btn { flex: 1; text-align: center; color: #aaa; font-size: 12px; cursor: pointer; transition: 0.3s; }
.nav-btn i { display: block; font-size: 20px; margin-bottom: 3px; }
.nav-btn:hover { color: #fff; }
.nav-btn.active { color: #ffcc00; font-weight: bold; }

.winnerCard{
  background:#111; color:#fff; border:1px solid rgba(0,213,255,0.08);
  border-radius:10px; padding:12px; margin-bottom:12px; font-size:14px;
}
.winnerCard b{color:#00d5ff;}
.winnerCard .small{color:#9aa; font-size:12px;}

.winner-card {
  display: flex;
  background: #0f0f0f;
  border-radius: 10px;
  border: 1px solid #242424;
  margin-bottom: 20px;
  overflow: hidden;
  color: #fff;
}

.winner-sidebar {
  width: 260px;
  background: #111827;
  padding: 20px;
  border-right: 2px solid #333;
}

.winner-sidebar h3 {
  margin: 0 0 10px;
  color: #4ADE80;
}

.winner-list {
  flex: 1;
  padding: 20px;
}

.winner-row {
  display: flex;
  align-items: center;
  gap: 15px;
  background: #1a1a1a;
  padding: 12px;
  border-radius: 10px;
  margin-bottom: 10px;
}

.winner-avatar {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  border: 3px solid #4ade80;
  object-fit: cover;
}

.winner-name {
  font-size: 18px;
  margin-bottom: 3px;
}

.no-winner {
  color: #999;
  font-style: italic;
}

/* üîΩ Slide Down Animation */
/* ‚öîÔ∏è WAR THEME STICKY BAR */
/* Wrapper for scrolling */
/* ========== PREMIUM BAR ========== */
/* ===================== PREMIUM SCROLL BAR ===================== */
/* Wrapper for scrolling */
.premium-wrapper {
  width: 100%;
  overflow: hidden;
  white-space: nowrap;
  position: sticky;
  top: 60px;        /* keeps it under navbar */
  z-index: 999;
  padding: 5px 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(4px);
  border-bottom: 1px solid rgba(255, 0, 0, 0.4);
}

/* Text inside scrolling bar */
.premium-text {
  display: inline-block;
  font-size: 13px;
  padding-left: 100%; /* start from right side */
  animation: scrollLeft 12s linear infinite,
             glow 2s ease-in-out infinite alternate,
             gradientFlow 6s linear infinite;

  background: linear-gradient(90deg, #ff0000, #ff8800, #ffd500);
  -webkit-background-clip: text;
  color: transparent;
}

/* ‚û§ Right ‚Üí Left scrolling */
@keyframes scrollLeft {
  0% { transform: translateX(0); }
  100% { transform: translateX(-100%); }
}

/* Glow effect */
@keyframes glow {
  from { text-shadow: 0 0 4px #ff4d4d; }
  to   { text-shadow: 0 0 10px #ff0000; }
}

/* Gradient Flow */
@keyframes gradientFlow {
  0%   { background-position: 0% 50%; }
  100% { background-position: 100% 50%; }
}

/* Mobile Only Fixes */
@media (max-width: 480px) {
  .premium-wrapper {
    top: 65px;
    padding: 4px 0;
  }
  .premium-text {
    font-size: 12px;
  }
}




/* ========== 1. PREMIUM BAR ========== */
.premium-wrapper {
  width: 100%;
  overflow: hidden;
  white-space: nowrap;
  position: sticky;
  top: 60px;
  z-index: 999;
  padding: 5px 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(4px);
  border-bottom: 1px solid rgba(255, 0, 0, 0.4);
}

.premium-text {
  display: inline-block;
  padding-left: 100%;
  font-size: 13px;
  animation: scrollLeft 12s linear infinite,
             glow 2s ease-in-out infinite alternate,
             gradientFlow 6s linear infinite;
  background: linear-gradient(90deg, #ff0000, #ff8800, #ffd500);
  -webkit-background-clip: text;
  color: transparent;
}

/* ========== 2. SUPPORT BAR ========== */
.support-wrapper {
  width: 100%;
  overflow: hidden;
  white-space: nowrap;
  position: sticky;
  top: 90px; /* appears directly under the premium bar */
  z-index: 998;
  padding: 4px 0;
  background: rgba(0, 0, 0, 0.3);
  border-bottom: 1px solid rgba(0, 255, 255, 0.4);
}

.support-text {
  display: inline-block;
  padding-left: 100%;
  font-size: 12px;
  animation: scrollLeft 14s linear infinite,
             blueGlow 2s ease-in-out infinite alternate;
  
  background: linear-gradient(90deg, #00ffee, #0099ff, #0055ff);
  -webkit-background-clip: text;
  color: transparent;
}

/* ========== SCROLLING ========== */
@keyframes scrollLeft {
  0% { transform: translateX(0); }
  100% { transform: translateX(-100%); }
}

/* Premium glow */
@keyframes glow {
  from { text-shadow: 0 0 4px #ff4d4d; }
  to   { text-shadow: 0 0 10px #ff0000; }
}

/* Support bar glow */
@keyframes blueGlow {
  from { text-shadow: 0 0 4px #00e6ff; }
  to   { text-shadow: 0 0 10px #008cff; }
}

@keyframes gradientFlow {
  0%   { background-position: 0% 50%; }
  100% { background-position: 100% 50%; }
}

/* ========== Mobile Friendly ========== */
@media (max-width: 480px) {
  .premium-wrapper { top: 60px; }
  .premium-text { font-size: 12px; }

  .support-wrapper { top: 88px; }
  .support-text { font-size: 11px; }
}

/* ========== PREMIUM SCROLLING BAR ========== */
.premium-wrapper {
  width: 100%;
  overflow: hidden;
  white-space: nowrap;
  position: sticky;
  top: 60px;
  z-index: 999;
  padding: 6px 0;
  background: rgba(0, 0, 0, 0.45);
  backdrop-filter: blur(4px);
  border-bottom: 1px solid rgba(255, 0, 0, 0.4);
}

.premium-text {
  display: inline-block;
  padding-left: 100%;
  font-size: 13px;

  animation: scrollLeft 12s linear infinite,
             glow 2s ease-in-out infinite alternate,
             gradientFlow 6s linear infinite;

  background: linear-gradient(90deg, #ff0000, #ff8800, #ffd500);
  -webkit-background-clip: text;
  color: transparent;
}

/* SCROLL ANIMATION */
@keyframes scrollLeft {
  from { transform: translateX(0); }
  to { transform: translateX(-100%); }
}

/* Glow */
@keyframes glow {
  from { text-shadow: 0 0 4px #ff4d4d; }
  to   { text-shadow: 0 0 10px #ff0000; }
}

/* Gradient Flow */
@keyframes gradientFlow {
  0%   { background-position: 0% 50%; }
  100% { background-position: 100% 50%; }
}

/* ========== SUPPORT BUTTON BELOW ========== */
.support-btn-wrapper {
  position: sticky;
  top: 95px;  
  width: 100%;
  z-index: 998;
  display: flex;
  justify-content: center;
  padding: 6px 0;
  background: rgba(0, 0, 0, 0.35);
  border-bottom: 1px solid rgba(0, 255, 255, 0.4);
}

.support-btn {
  font-size: 13px;
  font-weight: 600;
  padding: 6px 16px;
  border-radius: 20px;
  text-decoration: none;
  background: linear-gradient(90deg, #00d4ff, #007bff);
  color: #fff;
  box-shadow: 0px 0px 6px rgba(0, 195, 255, 0.7);
  transition: 0.2s ease;
}

.support-btn:active {
  transform: scale(0.95);
}

.support-btn:hover {
  filter: brightness(1.15);
}

/* ========== MOBILE SAFE ========== */
@media (max-width: 480px) {
  .premium-wrapper { top: 60px; }
  .premium-text { font-size: 12px; }

  .support-btn-wrapper { top: 90px; }
  .support-btn { font-size: 12px; padding: 5px 14px; }
} 



:root{--bg:#0b0b0b;--card:#151515;--muted:#cfcfcf;--accent:#00eaff}
  body{font-family:Poppins,system-ui,Arial;margin:0;background:var(--bg);color:#fff;padding:20px}
  h1{text-align:center;color:var(--accent);margin-bottom:18px}
  .game-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:14px;margin-bottom:20px}
  .game-card{background:var(--card);padding:18px;border-radius:12px;text-align:center;cursor:pointer;border:1px solid #222;transition:transform .14s,box-shadow .14s}
  .game-card:hover{transform:translateY(-6px);box-shadow:0 6px 18px rgba(0,0,0,.6)}
  .game-card.active{outline:3px solid rgba(0,234,255,.12);box-shadow:0 8px 30px rgba(0,234,255,.06)}
  .game-card h3{margin:12px 0 0;font-size:16px}
  .join-panel{max-width:520px;margin:0 auto;background:#0f0f0f;padding:18px;border-radius:12px;border:1px solid #1b1b1b}
  .form-row{margin-bottom:12px}
  label{display:block;color:var(--muted);font-size:13px;margin-bottom:6px}
  input,select{width:100%;padding:10px;border-radius:8px;border:none;background:#171717;color:#fff;font-size:15px}
  .btn{display:block;width:100%;padding:12px;border-radius:10px;border:none;background:var(--accent);color:#000;font-weight:700;cursor:pointer;margin-top:8px}
  .msg{margin-top:12px;font-size:14px}
  .inline-note{font-size:13px;color:var(--muted);margin-top:8px}

  .form-field { margin-bottom:10px; }
  input, select { width:100%; padding:8px; border-radius:8px; border:none; }
  button.primary {
    width:100%; padding:10px; background:#00eaff; border:none;
    margin-top:10px; border-radius:8px; font-weight:bold;
  }

  .update-note {
  text-align: center;
  font-size: 13px;
  padding: 10px 0;
  color: #cccccc;
  opacity: 0.85;
  margin-top: 20px;
}

@media (min-width: 768px) { .promo-bar { height: 80px; } .hero { height: 140px; } .content, #promosContainer, #winningInfo { margin-top: 290px; } } please marge this css in /* Modern premium dark UI */
    
</style>
</head>
<body>
<div class="page-loader" id="pageLoader">
    <div class="loader-box">
        <div style="position: relative; display:inline-block;">
            <img src="file_00000000c938722f8d26b428d0c8069c.png" class="page-loader-logo">
            <div class="shine"></div>
        </div>

        <h2 class="loader-text">Loading Game Zone</h2>

        <div class="loader-bar">
            <div class="loader-liquid"></div>
        </div>
    </div>
</div>

<nav><h1>Game Zone</h1><div id="navRight"></div></nav>

<div class="promo-bar"><div id="promoTrack" class="promo-track"></div></div>

<div class="hero"><h2>üî• Latest Promos üî•</h2></div>
<div id="promosContainer"></div>
<div class="premium-wrapper">
  <span class="premium-text">
    Welcome to GameZone! Play daily tournaments & matches, win prizes, climb the leaderboard. 
    Note: Never use hacks ‚Äî if detected, winnings will not be shared.
  </span>
</div>
<div class="support-wrapper">
  <span class="support-text">
    Facing any issue? Game problem, payment delay, or match error ‚Äî contact us on Help & Support page: help&support
  </span>
</div>

<div class="support-btn-wrapper">
  <a href="help&support.html" class="support-btn">Help & Support</a>
</div>


<h2 style="padding:10px; color:#ae00ff;">üèÜ Live Member Winnings</h2>

<!-- üéØ Live Leaderboard Section -->
<section id="leaderboardSection">
  <!-- Add this inside your <body>, maybe as a sidebar or at top-right corner -->
<div id="winnerSidebar" style="position:fixed; top:80px; right:20px; width:280px; max-height:80vh; overflow-y:auto; z-index:999;">
  <h3 style="color:#00d5ff; text-align:center; margin-bottom:10px;"></h3>
  <div id="winnerList"></div>
</div>

<div id="matches" style="max-width:700px;margin:auto;"></div>

  <h2 style="color:#ffcc00;">üèÖ Tournament Leaderboard</h2>
  <select id="leaderboardSelect">
    <option value="">Select Tournament</option>
  </select>
  <button id="leaderboardBtn" onclick="loadLeaderboard()">View Leaderboard</button>
  <div id="leaderboardContainer"></div>
</section>

<div class="content">
  <div id="filters">
    <input type="text" id="gameFilter" placeholder="Game name">
    <input type="text" id="modeFilter" placeholder="Mode (Solo/Duo/Squad)">
    <input type="date" id="dateFilter">
    <input type="number" id="entryFeeFilter" placeholder="Max Entry Fee">
    <button onclick="loadTournaments()">Apply Filters</button>
  </div>
  <div id="status"></div>
  <div class="game-grid" id="gameGrid"></div>
</div>

<div class="sidebar">
  <div class="nav-btn active" onclick="location.href='gamezone.html'"><i>üéÆ</i><span>Game</span></div>
  <div class="nav-btn" onclick="location.href='history.html'"><i>üìú</i><span>History</span></div>
  <div class="nav-btn" onclick="location.href='leaderboard.html'"><i>üèÜ</i><span>Leaderboard</span></div>
  <div class="nav-btn" onclick="location.href='profile.html'"><i>üë§</i><span>Profile</span></div>
  <div class="nav-btn" onclick="location.href='more.html'"><i>‚ãØ</i><span>More</span></div>
</div>

<div id="walletBalance">Fetching wallet balance...</div>
<!-- HTML -->
  <h1>Quick Match ‚Äî Join</h1>

<!-- Game Cards -->
<div class="game-grid" id="gameGrid">
  <div class="game-card" data-game="Ludo">
    <img src="unnamed.png" alt="Ludo" width="64" height="64" />
    <h3>Ludo</h3>
  </div>

  <div class="game-card" data-game="Carrom">
    <img src="unnamed (3).png" alt="Carrom" width="64" height="64" />
    <h3>Carrom</h3>
  </div>

  <div class="game-card" data-game="8 Ball Pool">
    <img src="unnamed (2).png" alt="8 Ball Pool" width="64" height="64" />
    <h3>8 Ball Pool</h3>
  </div>

  <div class="game-card" data-game="Cricket">
    <img src="unnamed (1).png" alt="Cricket" width="64" height="64" />
    <h3>Cricket</h3>
  </div>
</div>

<!-- Join Form -->
<div class="join-panel">
  <h2 id="selectedTitle" style="margin:0 0 12px">Pick a game to start</h2>

  <div id="formArea" style="display:none">
    <div class="form-row">
      <label>Match Type</label>
      <select id="matchType"></select>
    </div>

    <div class="form-row">
      <label>Mode</label>
      <select id="matchMode"></select>
    </div>

    <div class="form-row">
      <label>Entry Fee (‚Çπ)</label>
      <input type="number" id="entryFee" placeholder="e.g. 10" min="0" />
    </div>

    <div class="form-row">
      <label>Game UID</label>
      <input type="text" id="gameUID" placeholder="Enter your in-game UID" />
    </div>

    <div class="form-row">
      <label>WhatsApp Number</label>
      <input type="text" id="whatsapp" placeholder="Enter WhatsApp number (digits only)" />
    </div>

    <button class="btn" id="joinBtn">Join Match</button>
    <div class="msg" id="message"></div>
    <div class="inline-note">This client will send both top-level <code>whatsappNumber</code> and a <code>slots</code> array to match backend variants.</div>
  </div>
</div>

<!-- ACTIVE MATCH SECTION -->
<div id="activeMatchBox" style="margin-top:25px; display:none;">
  <h3>Your Active Match</h3>
  <div id="activeMatchContent" style="background:#131313;padding:15px;border-radius:10px;margin-top:10px;"></div>
</div>



 <div class="container">
    <!-- Left: selection -->
    <div class="card">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>BGMI & Free Fire Match War</h1>
          <p class="lead">Pick match size, choose winning system for team matches, then configure settings and join.</p>
        </div>
      </div>

      <div id="modeSection" class="mode-container active">
  <div class="mode-card" onclick="openMatchForm('1v1')"><h3>1v1</h3><p>Solo vs Solo</p></div>
  <div class="mode-card" onclick="openMatchForm('2v2')"><h3>2v2</h3><p>Duo Battles</p></div>
  <div class="mode-card" onclick="openMatchForm('3v3')"><h3>3v3</h3><p>Triple Team War</p></div>
  <div class="mode-card" onclick="openMatchForm('4v4')"><h3>4v4</h3><p>Squad Fight</p></div>
</div>

<div id="prizeSystemSection" class="section" style="display:none;text-align:center;">
    <h3>Select Winning System</h3>
    <div class="mode-container" style="margin-top:12px;">
      <div class="mode-card" onclick="selectPrizeSystem('kill_based')"><h3>Kill-Based</h3><p>Prize by kills</p></div>
      <div class="mode-card" onclick="selectPrizeSystem('team_equal')"><h3>Team Equal</h3><p>Winning team split equally</p></div>
    </div>
    <div style="text-align:center;margin-top:8px;">
      <button class="muted" onclick="backToModes()">‚¨Ö Back</button>
    </div>
  </div>

  <div id="matchForm" class="section" style="display:none;">
    <h2 id="selectedModeTitle">Join Match</h2>

    <input type="hidden" id="prizeSystem" value="">



<!-- Step 2: Match Details Form -->
<div class="form-field">
      <label>Game</label>
      <select id="game" onchange="updateGameModes()">
        <option value="BGMI">BGMI</option>
        <option value="PUBG">PUBG</option>
        <option value="Free Fire">Free Fire</option>
      </select>
    </div>

    <div class="form-field">
      <label>Game Mode</label>
      <select id="mode"></select>
    </div>

      <div class="form-field">
      <label>Entry Fee</label>
      <select id="entry-fee" onchange="toggleCustomFee()">
        <option value="50">‚Çπ50</option>
        <option value="100">‚Çπ100</option>
        <option value="150">‚Çπ150</option>
        <option value="200">‚Çπ200</option>
        <option value="custom">Custom</option>
      </select>
    </div>

    <div id="customFeeDiv" style="display:none" class="form-field">
      <input id="customFee" type="number" min="50" placeholder="Custom fee (min ‚Çπ50)">
    </div>

    <div class="form-field">
      <label>Game UID</label>
      <input id="uid" type="text" placeholder="Enter your Game UID">
    </div>

    <div style="display:flex;gap:8px;justify-content:center;margin-top:10px;">
      <button class="primary" onclick="joinMatch()">Join Match</button>
      <button class="muted" onclick="showHome()">Cancel</button>
    </div>

    <div class="message" id="form-message"></div> 

  </div>


<div class="update-note">
  More updates coming soon. Thank you for being with us.
</div>


<script>
const API_BASE = "http://localhost:5000/api/wallet";
const token = localStorage.getItem('token');
const UPLOADS_BASE = "http://localhost:5000/uploads";
const BACKEND_URL = API_BASE;

let selectedMode = null;
let selectedPrizeSystem = null;

// Single formatDateTime utility (accepts date string or object or tournament)
function formatDateTime(t) {
  if (!t) return '-';
  // if passed tournament object with date/time
  if (typeof t === 'object' && (t.date || t.time)) {
    const d = new Date(t.date || t);
    return t.time ? `${d.toLocaleDateString()} ${t.time}` : d.toLocaleString();
  }
  const d = new Date(t);
  return d.toLocaleString();
}

// Mode / prize selection flow
// Open match form based on selected mode
// Mode / prize selection flow
// Open match form based on selected mode
function openMatchForm(mode) {
  selectedMode = mode;
  document.getElementById("selectedModeTitle").textContent = `Mode: ${mode}`;
  updateGameModes();
  toggleSection('modeSection', false);

  // ‚úÖ Show prize system only for team matches
  if (mode === '1v1') {
    // Directly show match form, skip prize system
    selectedPrizeSystem = 'kill_based'; // default for 1v1
    document.getElementById('prizeSystem').value = selectedPrizeSystem;
    document.getElementById('matchForm').style.display = 'block';
    document.getElementById('selectedModeTitle').textContent = `Join ${selectedMode} Match (Kill Based)`;
  } else {
    // Show prize system selection for team matches
    document.getElementById('prizeSystemSection').style.display = 'block';
  }
}

// When a prize system is selected for team matches
function selectPrizeSystem(system){
  selectedPrizeSystem = system;
  document.getElementById('prizeSystem').value = system;
  document.getElementById('prizeSystemSection').style.display = 'none';
  document.getElementById('matchForm').style.display = 'block';
  document.getElementById('selectedModeTitle').textContent = `Join ${selectedMode} Match (${system === 'kill_based' ? 'Kill Based' : 'Team Equal'})`;
}

function backToModes(){
  document.getElementById('prizeSystemSection').style.display = 'none';
  document.getElementById('modeSection').style.display = 'grid';
}

function showHome(){
  document.getElementById('matchForm').style.display = 'none';
  document.getElementById('modeSection').style.display = 'grid';
  document.getElementById('prizeSystemSection').style.display = 'none';
  document.getElementById('form-message').textContent = '';
}

function toggleSection(id, show){
  const el = document.getElementById(id);
  if(!el) return;
  if(show) el.classList.add('active'); else el.classList.remove('active');
}

function toggleCustomFee(){
  document.getElementById('customFeeDiv').style.display = document.getElementById('entry-fee').value === 'custom' ? 'block' : 'none';
}

function updateGameModes(){
  const game = document.getElementById('game').value;
  const modeSelect = document.getElementById('mode');
  modeSelect.innerHTML = '';
  const modes = game === 'Free Fire' ? ['Custom Room'] : ['TDM','Gun Game'];
  modes.forEach(m=>{
    const o = document.createElement('option');
    o.value = m;
    o.textContent = m;
    modeSelect.appendChild(o);
  });
}

// --- Join flow (deduct -> join) ---
async function joinMatch(){
  const msgDiv = document.getElementById('form-message');
  msgDiv.textContent = '';

  if(!selectedMode){ msgDiv.textContent = '‚ö† Select match type first'; return; }
  if(!selectedPrizeSystem){ msgDiv.textContent = '‚ö† Select prize system first'; return; }

  const game = document.getElementById('game').value;
  const mode = document.getElementById('mode').value;
  const uid = document.getElementById('uid').value.trim();
  const feeSelect = document.getElementById('entry-fee').value;
  const customFee = document.getElementById('customFee').value.trim();
  const fee = feeSelect === 'custom' ? parseInt(customFee||0,10) : parseInt(feeSelect,10);

  if(isNaN(fee) || fee < 50){ msgDiv.textContent = '‚ö† Minimum entry fee is ‚Çπ50.'; return; }
  if(!uid){ msgDiv.textContent = '‚ö† Enter your game UID'; return; }

  try{
    msgDiv.textContent = 'üí∞ Deducting entry fee...';
    const deductRes = await fetch(`${BACKEND_URL}/deduct`, {
      method:'POST',
      headers:{ 'Content-Type':'application/json', ...(token?{ Authorization:'Bearer '+token }: {}) },
      body: JSON.stringify({ fee })
    });
    const deductData = await deductRes.json();
    if(!deductRes.ok || !deductData.success) throw new Error(deductData.msg || 'Deduction failed');

    msgDiv.textContent = 'üéÆ Joining match...';
    const joinRes = await fetch(`${BACKEND_URL}/joins`, {
      method:'POST',
      headers:{ 'Content-Type':'application/json', ...(token?{ Authorization:'Bearer '+token }: {}) },
      body: JSON.stringify({ type: selectedMode, game, mode, fee, uid, prizeSystem: selectedPrizeSystem })
    });
    const joinData = await joinRes.json();
    if(!joinRes.ok || !joinData.success) throw new Error(joinData.msg || 'Failed to join');

    msgDiv.textContent = `‚úÖ Joined! Match ID: ${joinData.match._id} ‚Äî Redirecting...`;
    fetchWalletBalance();
    setTimeout(()=>{ window.location.href = `user-room.html?matchId=${joinData.match._id}&uid=${encodeURIComponent(uid)}` }, 800);

  }catch(err){
    console.error('join err',err);
    msgDiv.textContent = `‚ùå ${err.message || 'Join failed'}`;
  }
} 
// --- Load tournaments ---
async function loadTournaments() {
  const status = document.getElementById("status");
  status.innerText = "Loading tournaments...";

  try {
    const res = await fetch(`${API_BASE}/tournaments`, { headers: { Authorization: `Bearer ${token}` } });
    if (!res.ok) throw new Error("Failed to fetch tournaments");
    const tournaments = await res.json();

    const grid = document.getElementById("gameGrid");
    grid.innerHTML = "";

    tournaments.forEach(t => {
      const leaveLocked = t.roomUploaded || (t.roomInfo && t.roomInfo.roomId) || t.roomId || t.resultsUploaded;

      const div = document.createElement("div");
      div.className = "game-card";
      div.innerHTML = `
        <img src="${UPLOADS_BASE}/${t.poster}" alt="Poster" height="250">
        <h3>${t.name}</h3>
        <p>Game: ${t.game}</p>
        <p>Mode: ${t.mode}</p>
        <p>Entry Fee: ‚Çπ${t.entryFee}</p>
        <p>Prize: ‚Çπ${t.prizePool}</p>
        <p>Players Joined: ${t.joinedUsers?.length || 0}/${t.maxPlayers}</p>
        <p>Date & Time: ${formatDateTime(t)}</p>
        <button onclick="joinTournament('${t._id}')">Join</button>
        ${leaveLocked
          ? `<button disabled style="opacity:0.5;cursor:not-allowed;">Leave Locked üîí</button>`
          : `<button onclick="leaveTournament('${t._id}')">Leave</button>`
        }
        <button onclick="viewTournament('${t._id}')">View</button>
      `;
      grid.appendChild(div);
    });

    status.innerText = "Loaded successfully!";
  } catch (err) {
    console.error("Load error:", err);
    status.innerText = "Failed to load tournaments.";
  }
}


async function joinTournament(id){ if(!token){ alert('Login required'); window.location.href='login.html'; return; } window.location.href = `uid.html?id=${id}`; }

async function leaveTournament(id){ if(!confirm('Are you sure you want to leave?')) return; try{ const res = await fetch(`${API_BASE}/leave/${id}`, { method:'DELETE', headers:{ Authorization:'Bearer '+token }}); const d = await res.json(); alert(d.msg || 'Left'); loadTournaments(); }catch(e){ console.error(e); alert('Failed to leave'); } }

async function viewTournament(id){ try{ const res = await fetch(`${API_BASE}/tournaments/${id}`, { headers: token?{ Authorization:'Bearer '+token }:{} }); const t = await res.json(); if(!res.ok){ alert(t.msg || 'Failed'); return; } if(t.joined){ alert(`Tournament: ${t.name}\nGame: ${t.game}\nDate: ${formatDateTime(t.date||t.startTime)}\nRoom ID: ${t.roomInfo?.roomId || 'N/A'}\nPass: ${t.roomInfo?.roomPassword || 'N/A'}`); try{ await fetch(`${API_BASE}/tournaments/${id}/room-seen`, { method:'POST', headers:{ Authorization:'Bearer '+token }}); }catch(e){} loadTournaments(); } else { alert('You must join to view room details.'); } }catch(e){ console.error(e); alert('Failed to view tournament'); } }

// Leaderboard helpers
async function loadLeaderboardTournaments(){ try{ const res = await fetch(`${API_BASE}/tournaments`, { headers: token?{ Authorization:'Bearer '+token }:{} }); if(!res.ok) return; const arr = await res.json(); const sel = document.getElementById('leaderboardSelect'); sel.innerHTML = '<option value="">Select Tournament</option>'; (arr||[]).forEach(t=>{ const o = document.createElement('option'); o.value = t._id; o.textContent = `${t.name||t.title||'Tournament'} (${t.game})`; sel.appendChild(o); }); }catch(e){ console.error(e); } }

async function loadLeaderboard(){ const tid = document.getElementById('leaderboardSelect').value; if(!tid) return alert('Select tournament first'); const container = document.getElementById('leaderboardContainer'); container.innerHTML = 'Loading...'; try{ const res = await fetch(`${API_BASE}/leaderboard/${tid}`); const d = await res.json(); if(!d.leaderboard || !d.leaderboard.length){ container.innerHTML = `<div>No winners yet for ${d.tournamentName || tid}</div>`; return; } const sorted = d.leaderboard.sort((a,b)=>a.position-b.position); container.innerHTML = ` <div style="display:flex;gap:12px;align-items:flex-end;justify-content:center;margin-top:8px"> ${[1,2,3].map(pos=>{ const p = sorted.find(x=>x.position===pos) || {name:'Waiting...', avatarUrl:'https://cdn-icons-png.flaticon.com/512/147/147144.png', prize:0}; return `<div style="background:#111;padding:10px;border-radius:10px;text-align:center;width:140px;"><img src="${p.avatarUrl}" style="width:70px;height:70px;border-radius:50%;border:3px solid #00faff"><h4>${pos===1?'ü•á':pos===2?'ü•à':'ü•â'} ${p.name}</h4><div>‚Çπ${p.prize}</div></div>` }).join('')} </div>`; }catch(e){ console.error('leaderboard err',e); container.innerHTML='Error'; } }

// Promos & dummy wins
async function loadPromos(){ try{ const r = await fetch(`${API_BASE}/promos`); const promos = r.ok ? await r.json() : []; const track = document.getElementById('promoTrack'); track.innerHTML=''; const container = document.getElementById('promosContainer'); container.innerHTML=''; if(!promos || !promos.length) promos = [{title:'Sponsor', images:['https://picsum.photos/200/100']}]; promos.forEach(p=>{ const div = document.createElement('div'); div.className='promo-item'; const imgs = (p.images||[]).map(i=>`<img src="${UPLOADS_BASE}/${i}" alt="">`).join(''); div.innerHTML = `<strong style="display:block;margin-bottom:6px">${p.title}</strong>${imgs}`; track.appendChild(div); const lp = document.createElement('div'); lp.className='latest-promo'; lp.innerHTML = `<strong style="display:block;margin-bottom:6px">${p.title}</strong>${imgs}`; container.appendChild(lp); }); const winContainer = document.getElementById('winningInfo'); winContainer.innerHTML=''; const dummyWins = [ { game: "BGMI", member: "PlayerX", prize: 500 }, { game: "Free Fire", member: "Hero123", prize: 300 }, { game: "CODM", member: "Sniper99", prize: 700 }, { game: "BGMI", member: "AcePro", prize: 1000 } ]; dummyWins.forEach(w=>{ const div = document.createElement('div'); div.className='win-card'; div.innerHTML=`<h4>${w.game}</h4><p>Member: ${w.member}</p><p>Winning: ‚Çπ${w.prize}</p>`; winContainer.appendChild(div); }); }catch(err){ console.error(err); } }

// Active match
// Active match
// Active match
async function loadActiveMatch() {
  const token = localStorage.getItem("token");
  if (!token) return;

  try {
    const res = await fetch(`${BACKEND_URL}/my-active`, {
      headers: { Authorization: `Bearer ${token}` }
    });

    const data = await res.json();

    const activeBox = document.getElementById('activeMatchBox');
    const activeContent = document.getElementById('activeMatchContent');

    if (!data.success || !data.data?.length) {
      activeBox.style.display = 'none';
      return;
    }

    const match = data.data[0];
    activeBox.style.display = 'block';

    // üéØ STATUS DISPLAY
    const statusText =
      match.status === 'room_published'
        ? `<span style="color:#45ff45;">Room Published ‚úÖ</span>`
        : `<span style="color:yellow;">Waiting for Admin to Upload Room ‚è≥</span>`;

    // üéÆ GAMES WHERE PRIZE SYSTEM SHOULD BE HIDDEN
    const hidePrizeGames = ["ludo", "carrom", "8 ball pool", "cricket"];

    const gameLower = match.game?.toLowerCase() || "";

    let prizeSystemBlock = "";

    // ‚ùå Hide for Ludo/Carrom/8 Ball Pool/Cricket
    if (!hidePrizeGames.includes(gameLower)) {
      let prizeLabel = "-";

      if (match.prizeSystem === "kill_based") prizeLabel = "Kill Based";
      else if (match.prizeSystem === "team_equal") prizeLabel = "Team Equal";

      prizeSystemBlock = `<p><strong>Prize System:</strong> ${prizeLabel}</p>`;
    }

    activeContent.innerHTML = `
      <p><strong>Game:</strong> ${match.game}</p>
      <p><strong>Mode:</strong> ${match.mode}</p>
      <p><strong>Type:</strong> ${match.type}</p>
      <p><strong>Entry:</strong> ‚Çπ${match.entryFee}</p>

      ${prizeSystemBlock}

      <p><strong>Status:</strong> ${statusText}</p>
      <p style="margin-top:6px;opacity:0.8;"><strong>Match ID:</strong> ${match._id}</p>

      <br>
      <strong>Players:</strong><br>
      ${match.players
        .map((p, i) => `${i + 1}. ${p.name || p.uid} (${p.uid})`)
        .join("<br>")}
      <br><br>

      <button style="margin-top:10px;padding:8px 12px;border-radius:8px;border:none;background:#00d5ff" onclick="gotoRoom('${match._id}')">
        View Room
      </button>
    `;
  } catch (err) {
    console.error(err);
  }
}

function gotoRoom(matchId) {
  window.location.href = `user-room.html?matchId=${matchId}`;
}







async function fetchWalletBalance(){ const walletDiv = document.getElementById('walletBalance'); if(!token){ walletDiv.textContent = 'üí∞ Wallet Balance: (login required)'; return; } try{ const res = await fetch(`${BACKEND_URL}/balance`, { headers: { 'Content-Type':'application/json', ...(token?{ Authorization:`Bearer ${token}` }:{} ) } }); if(!res.ok) throw new Error('fetch failed'); const d = await res.json(); walletDiv.textContent = `üí∞ Wallet Balance: ‚Çπ${d.balance ?? 0}`; }catch(e){ console.error('wallet fetch err',e); document.getElementById('walletBalance').textContent = '‚ö† Failed to fetch wallet balance'; } }

function gotoProfile(){ location.href='profile.html'; }


async function loadRecentWinners(){
  const container = document.getElementById("winnerList");
  container.innerHTML = "Loading...";
  try{
    const res = await fetch(`${API_BASE}/admin/match/results`, {
      method:"GET",
      headers:{ "Authorization":"Bearer "+token, "Content-Type":"application/json" }
    });
    const data = await res.json();
    if(!data.success){ container.innerHTML = "Failed to load winners."; return; }

    const matches = data.list.filter(m=>m.completed); // only completed matches
    if(!matches.length){ container.innerHTML = ""; return; }

    const cards = matches.map(match=>{
      let winner = null;
      const prizeSystem = match.prizeSystem || "team_equal";
      const players = (match.results || match.data || []).map(p=>({
        userId:p.userId, name:p.name||"-", team:p.team||"-", kills:Number(p.kills)||0
      }));

      if(match.type==="1v1"){
        winner = players.sort((a,b)=>b.kills-a.kills)[0];
      } else {
        const winnerTeam = match.winnerTeam;
        const winnerPlayers = players.filter(p=>p.team===winnerTeam);
        if(prizeSystem==="team_equal"){
          const totalCollected = (match.entryFee * players.length);
          const prizePool = totalCollected - totalCollected*0.08;
          winnerPlayers.forEach(p=> p.share = prizePool / winnerPlayers.length);
          winner = winnerPlayers[0]; // show first in team
        } else {
          const totalKills = winnerPlayers.reduce((s,p)=>s+p.kills,0);
          const totalCollected = (match.entryFee * players.length);
          const prizePool = totalCollected - totalCollected*0.08;
          winnerPlayers.forEach(p=> p.share = totalKills ? (p.kills/totalKills)*prizePool : prizePool/winnerPlayers.length);
          winner = winnerPlayers.sort((a,b)=>b.share - a.share)[0]; // top share
        }
      }

      const winningPrice = winner.share ? winner.share.toFixed(2) : "0.00";

      return `
        <div class="winnerCard">
          <b>${winner.name}</b><br>
          <span class="small">Match #${match.matchNumber}</span><br>
          <span class="small">${match.game} ‚Ä¢ ${match.mode}</span><br>
          <span class="small">Winning: ‚Çπ${winningPrice}</span>
        </div>
      `;
    }).join("");

    container.innerHTML = cards;

  }catch(err){
    console.error(err);
    container.innerHTML = "Network error while loading winners.";
  }
}




async function fetchWinners() {
  try {
    const res = await fetch('http://localhost:5000/api/wallet/matches/winners');
    const data = await res.json();
    const container = document.getElementById('matches');
    container.innerHTML = '';

    if (!data.success || !data.list.length) {
      container.innerHTML = '<p style="text-align:center;">No winners yet.</p>';
      return;
    }

    const matches = data.list.slice(0,3); // Only last 3 matches for slideshow
    let index = 0;

    function renderMatch(i) {
      const match = matches[i];
      let winnersHTML = '';

      if (match.winners.length === 0) {
        winnersHTML = '<p class="no-winner">No winners declared</p>';
      } else {
        winnersHTML = match.winners.map(p => `
          <div class="winner-row" style="display:flex;align-items:center;margin:8px 0;padding:6px;background:#111;border-radius:10px;">
            <img src="${p.avatarUrl || 'https://i.ibb.co/2d1zY0m/user.png'}" 
                 alt="${p.name}" 
                 style="width:50px;height:50px;border-radius:50%;object-fit:cover;margin-right:12px;" />
            <div style="flex:1;color:#fff;">
              <p style="margin:0;font-weight:600;">${p.name} (${p.uid})</p>
              
              <p style="margin:0;color:#0dfc89;">Winning Price: ‚Çπ${p.winningPrice}</p>
            </div>
          </div>
        `).join('');
      }

      const html = `
        <div class="winner-card" style="
          display:flex;
          background:#1a1a1a;
          border-radius:16px;
          padding:16px;
          color:white;
          box-shadow:0 0 12px rgba(0,0,0,0.5);
          animation:fade 0.5s ease;
        ">
          <div class="winner-sidebar" style="flex:0 0 180px; padding-right:12px; border-right:1px solid #333;">
            <h3 style="margin-bottom:6px;">${match.matchNumber}</h3>
            <p style="margin:2px 0;"><strong>Type:</strong> ${match.type}</p>
            <p style="margin:2px 0;"><strong>Game:</strong> ${match.game}</p>
            <p style="margin:2px 0;"><strong>Mode:</strong> ${match.mode}</p>
            <p style="margin:2px 0;"><strong>Prize System:</strong> ${match.prizeSystem || 'N/A'}</p>
            <p style="margin:2px 0;color:#ffd700;"><strong>Total Prize:</strong> ‚Çπ${match.prizeGiven}</p>
            <p style="margin:2px 0;font-size:12px;color:#aaa;"><strong>Completed:</strong><br>${new Date(match.completedAt).toLocaleString()}</p>
          </div>
          <div class="winner-list" style="flex:1; padding-left:12px;">
            <h4 style="margin-top:0;color:#0dfc89;">Winner Players</h4>
            ${winnersHTML}
          </div>
        </div>
        <style>
          @keyframes fade {
            from { opacity:0; transform:translateY(10px);}
            to { opacity:1; transform:translateY(0);}
          }
        </style>
      `;

      container.innerHTML = html;
    }

    // initial render
    renderMatch(index);

    // auto slideshow every 5 seconds
    setInterval(() => {
      index = (index + 1) % matches.length;
      renderMatch(index);
    }, 5000);

  } catch (err) {
    console.error("Error fetching winners:", err);
    document.getElementById('matches').innerHTML = '<p style="text-align:center;">Error loading winners.</p>';
  }
}

// FRONTEND JS

document.addEventListener("DOMContentLoaded", () => {

  /* -------------------------
     GAME CONFIG
  --------------------------*/
  const GAME_CONFIG = { 
    "Ludo": {
      types: ["1v1","1v2","1v3","2v2"],
      modes: ["classic","popular","quick"],
    },
    "Carrom": {
      types: ["1v1","2v2"],
      modes: ["classic","freestyle"],
    },
    "8 Ball Pool": {
      types: ["1v1"],
      modes: ["classic"]
    },
    "Cricket": {
      types: ["1v1"],
      modes: ["1 over"]
    }
  };

  /* -------------------------
     ELEMENTS
  --------------------------*/
  const gameGrid = document.getElementById('gameGrid');
  const selectedTitle = document.getElementById('selectedTitle');
  const formArea = document.getElementById('formArea');
  const matchType = document.getElementById('matchType');
  const matchMode = document.getElementById('matchMode');
  const entryFee = document.getElementById('entryFee');
  const gameUID = document.getElementById('gameUID');
  const whatsapp = document.getElementById('whatsapp');
  const joinBtn = document.getElementById('joinBtn');
  const message = document.getElementById('message');

  let selectedGame = null;

  function setMessage(text, color='lightgreen') {
    message.style.color = color;
    message.textContent = text;
  }

  /* -------------------------
     GAME CARD CLICK FIXED
  --------------------------*/
  document.querySelectorAll('.game-card').forEach(card => {
    card.addEventListener('click', () => {
      document.querySelectorAll('.game-card').forEach(c => c.classList.remove('active'));
      card.classList.add('active');

      selectedGame = card.dataset.game;
      selectedTitle.textContent = "Joining: " + selectedGame;
      formArea.style.display = 'block';

      populateTypeMode(selectedGame);
    });
  });

  /* -------------------------
     Populate Type + Mode
  --------------------------*/
  function populateTypeMode(game) {
    const cfg = GAME_CONFIG[game];
    matchType.innerHTML = "";
    matchMode.innerHTML = "";

    cfg.types.forEach(t => {
      const opt = document.createElement("option");
      opt.value = t;
      opt.textContent = t;
      matchType.appendChild(opt);
    });

    cfg.modes.forEach(m => {
      const opt = document.createElement("option");
      opt.value = m;
      opt.textContent = m;
      matchMode.appendChild(opt);
    });
  }

  /* -------------------------
     JOIN BUTTON ‚Äî SAME AS BEFORE
  --------------------------*/
  joinBtn.addEventListener("click", async () => {
    setMessage("");

    const payload = {
      game: selectedGame,
      type: matchType.value,
      mode: matchMode.value,
      entryFee: Number(entryFee.value),
      uid: gameUID.value.trim(),
      whatsappNumber: whatsapp.value.trim()
    };

    if (!payload.game) return setMessage("Select a game!", "salmon");
    if (!payload.uid) return setMessage("Enter your UID", "salmon");
    if (!payload.whatsappNumber) return setMessage("Enter WhatsApp Number", "salmon");

    const API = "http://localhost:5000/api/wallet/join";
    const token = localStorage.getItem("token");

    try {
      setMessage("Joining...");

      const res = await fetch(API, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          ...(token ? { "Authorization": `Bearer ${token}` } : {})
        },
        body: JSON.stringify(payload)
      });

const data = await res.json();

if (res.ok && data.success) {
  // Show success message
  setMessage("Joined successfully!");

  // Redirect to user-room.html with matchId
  window.location.href = data.redirectUrl || `user-room.html?matchId=${data.matchId}`;
} 

       else {
        setMessage("‚ùå " + data.msg, "salmon");
      }
    } catch (err) {
      setMessage("Network error", "salmon");
    }
  });

}); // END DOMContentLoaded




// fetch on load
fetchWinners();



// refresh every 30 seconds
loadRecentWinners();
setInterval(loadRecentWinners, 30000);

// Init
window.addEventListener('DOMContentLoaded', ()=>{
  updateGameModes();
  loadPromos();
  loadLeaderboardTournaments();
  loadTournaments();
  fetchWalletBalance();
  loadActiveMatch();
});


    window.addEventListener("load", () => {
        setTimeout(() => {
            document.getElementById("pageLoader").classList.add("hide-loader");
        }, 400);
    });



</script>
</body>
</html> 









<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Admin ‚Äî Complete Match Results & Payout</title>
<style>
  :root{
    --bg:#0b0b0b; --card:#111; --accent:#00d5ff; --muted:#9aa; --ok:#4ade80; --danger:#ff5b5b;
  }
  body{
    font-family: Inter, Poppins, system-ui, sans-serif;
    background:var(--bg); color:#fff; padding:18px;
  }
  h1{ color:var(--accent); text-align:center; margin-bottom:18px; }
  .wrap{ max-width:1100px; margin:0 auto; }
  .match{ background:var(--card); padding:14px; border-radius:10px; margin-bottom:18px;
          border:1px solid rgba(0,213,255,0.06); }
  .meta{ display:flex; gap:12px; align-items:center; margin-bottom:12px; }
  .meta b{ color:var(--accent); }
  table{ width:100%; border-collapse:collapse; margin-top:10px; }
  th,td{ padding:8px; border-bottom:1px solid rgba(255,255,255,0.04); text-align:left; font-size:14px; vertical-align:middle;}
  th{ color:var(--accent); }
  .thumb{ width:72px; height:64px; object-fit:cover; border-radius:6px; cursor:pointer; border:1px solid rgba(0,213,255,0.06); }
  .controls{ display:flex; gap:8px; flex-wrap:wrap; margin-top:12px; align-items:center; }
  .controls-right{ margin-left:auto; display:flex; gap:8px; align-items:center; }
  .btn{ background:var(--accent); color:#000; border:none; padding:8px 12px; border-radius:8px; cursor:pointer; font-weight:600; }
  .btn:disabled{ opacity:.6; cursor:not-allowed; }
  .btn-danger{ background:var(--danger); color:#fff; }
  .btn-win{ background:var(--ok); color:#000; font-weight:700; padding:6px 10px; border-radius:8px; border:none; cursor:pointer; }
  .small{ font-size:13px; color:var(--muted); }
  .resultPreview{ background:#0f1720; padding:10px; border-radius:8px; margin-top:10px; border:1px solid rgba(255,255,255,0.03); }
  .inputKills{ width:80px; padding:6px; border-radius:6px; border:1px solid #222; background:#0b0b0b; color:#fff; }
  .info{ color:var(--muted); font-size:13px; }
  .loading{ color:var(--accent); text-align:center; margin:14px 0; }
  .modal{ display:none; position:fixed; inset:0; background:rgba(0,0,0,.85); align-items:center; justify-content:center; z-index:9999; }
  .modal img{ max-width:90%; max-height:90%; border-radius:8px; border:4px solid var(--accent); }
  .closeX{ position:absolute; top:18px; right:22px; color:var(--accent); font-size:28px; cursor:pointer; }
  .label{ font-size:13px; color:var(--muted); margin-right:6px; }
  select,input[type="text"]{ background:#0b0b0b; border:1px solid #222; color:#fff; padding:6px; border-radius:6px; }
  @media (max-width:720px){
    .meta{ flex-direction:column; align-items:flex-start; }
    .controls-right{ margin-left:0; width:100%; justify-content:flex-end; }
    .controls{ flex-direction:column; align-items:flex-start; }
    .btn{ width:100%; }
  }
</style>
</head>
<body>
  <div class="wrap">
    <h1>Admin ‚Äî Complete Match Results & Payout</h1>

    <div id="error" class="info" style="display:none;margin-bottom:12px"></div>
    <div id="loading" class="loading">Loading matches...</div>

    <!-- Top controls -->
    <div style="display:flex;gap:10px;align-items:center;margin-bottom:12px">
      <div class="label">API Base:</div>
      <input id="apiBaseInput" type="text" value="http://localhost:5000/api/wallet" style="min-width:320px">
      <button class="btn" id="saveApiBtn">Save</button>
      <div style="margin-left:auto">
        <button class="btn btn-danger" id="clearTokenBtn">Clear token</button>
      </div>
    </div>

    <div id="matches"></div>
  </div>

  <!-- Screenshot modal -->
  <div class="modal" id="modal">
    <span class="closeX" id="closeModalBtn">√ó</span>
    <img id="modalImg" src="" alt="screenshot">
  </div>

<script>
/* ------------------ Config / Helpers ------------------ */
let API_BASE = localStorage.getItem('adminApiBase') || "http://localhost:5000/api/wallet";
document.getElementById('apiBaseInput').value = API_BASE;
const token = localStorage.getItem("token") || "";

document.getElementById('saveApiBtn').addEventListener("click", ()=>{
  API_BASE = document.getElementById('apiBaseInput').value.trim() || API_BASE;
  localStorage.setItem('adminApiBase', API_BASE);
  alert('API base saved: ' + API_BASE);
});

document.getElementById('clearTokenBtn').addEventListener("click", ()=>{
  localStorage.removeItem('token');
  alert('Admin token cleared.');
});

document.getElementById('closeModalBtn').addEventListener("click", ()=>{ document.getElementById('modal').style.display='none'; });

function showError(msg){ const e = document.getElementById("error"); e.style.display = msg ? "block" : "none"; e.innerText = msg || ""; }
function showLoading(flag){ document.getElementById("loading").style.display = flag ? "block" : "none"; }
function openModal(src){ const modal = document.getElementById("modal"); document.getElementById("modalImg").src = src; modal.style.display='flex'; }
function escapeHtml(s){ if(s===null||s===undefined) return ""; return String(s).replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

/* per-match selection: either { type:'user', id:userId } or { type:'team', id:'LION' } */
const selection = {};
const SIMPLE_GAMES = ["ludo","carrom","8 ball pool","8ball","cricket"];
const KILL_GAMES   = ["bgmi","pubg","free fire","freefire","free-fire"];

/* ------------------ Load matches ------------------ */
async function loadMatches(){
  showError("");
  if(!token){ showError("Admin token missing ‚Äî store admin token at localStorage key 'token'"); showLoading(false); return; }
  showLoading(true);
  try{
    const r = await fetch(`${API_BASE}/admin/match/results`, { method: "GET", headers: { "Authorization": "Bearer " + token } });
    const data = await r.json();
    if(!data.success){ showError(data.msg || "Failed loading matches"); document.getElementById("matches").innerHTML = ""; return; }
    renderMatches(data.list || []);
  }catch(err){
    console.error(err);
    showError("Network error while loading matches");
    document.getElementById("matches").innerHTML = "";
  } finally { showLoading(false); }
}

/* ------------------ Render Matches ------------------ */
function renderMatches(list){
  const container = document.getElementById("matches");
  container.innerHTML = "";
  if(!Array.isArray(list) || list.length === 0){
    container.innerHTML = `<div class="info">No match results available.</div>`;
    return;
  }

  list.forEach(match => {
    // normalize results list
    const rawPlayers = Array.isArray(match.results) && match.results.length ? match.results : (Array.isArray(match.userResults) && match.userResults.length ? match.userResults : (Array.isArray(match.players) ? match.players : []));
    const players = rawPlayers.map((p, idx) => {
      let userId = "";
      let name = p.name || "-";
      let uidDisplay = p.uid || (p.userId && p.userId.uid) || "";
      let team = p.team || p.userTeam || "";
      let kills = Number(p.kills || 0);
      let screenshot = p.screenshotUrl || p.screenshot || "";
      let uploadedAt = p.uploadedAt || p.createdAt || p.uploaded || null;

      if(p.userId){
        if(typeof p.userId === "object"){
          userId = p.userId._id || p.userId.id || "";
          name: p.name || (p.userId && p.userId.name) || "-";
          
          
        } else {
          userId = p.userId;
        }
      } else {
        userId = p.user || p._id || String(idx);
      }

      return {
        userId: String(userId),
        name: String(name),
        uidDisplay: String(uidDisplay || ""),
        team: String(team || ""),
        kills,
        screenshotUrl: String(screenshot || ""),
        uploadedAt: uploadedAt || null,
        prize: Number(p.prize || 0),
        result: p.result || ""
      };
    });

    // Build match DOM block
    const matchDiv = document.createElement("div");
    matchDiv.className = "match";
    matchDiv.id = "match_" + (match._id || Math.random().toString(36).slice(2));

    // header/meta
    const prizeSystem = match.prizeSystem || "team_equal";
    const matchGame = String(match.game || "").toLowerCase();

    // create HTML safely using escaped pieces
    let html = '';
    html += `<div class="meta">`;
    html += `<div><b>Match #${escapeHtml(match.matchNumber || match._id || "")}</b>`;
    html += `<div class="small">${escapeHtml(match.game || "Unknown")} ‚Ä¢ ${escapeHtml(match.mode || "-")} ‚Ä¢ ${escapeHtml(match.type || "-")}</div></div>`;
    html += `<div class="controls-right"><label class="label small">Prize system</label>`;
    html += `<select id="ps_${escapeHtml(String(match._id))}">`;
    html += `<option value="">(use match)</option>`;
    html += `<option value="team_equal"${prizeSystem==="team_equal" ? " selected" : ""}>team_equal</option>`;
    html += `<option value="kill_based"${prizeSystem==="kill_based" ? " selected" : ""}>kill_based</option>`;
    html += `</select></div></div>`;

    // table header
    html += `<table><thead><tr><th>Winner</th><th>Player</th><th>Team</th><th>Kills</th><th>Screenshot</th><th>Uploaded</th><th>Prize</th></tr></thead><tbody>`;

    players.forEach(p => {
      const rowBg = p.result === 'win' ? ' style="background:rgba(74,222,128,0.06)"' : '';
      html += `<tr data-userid="${escapeHtml(p.userId)}"${rowBg}>`;
      html += `<td style="white-space:nowrap"><button type="button" class="btn-win select-user" data-match="${escapeHtml(match._id)}" data-user="${escapeHtml(p.userId)}" data-name="${escapeHtml(p.name)}">WIN</button></td>`;
      html += `<td>${escapeHtml(p.name)}<br><small class="small">${escapeHtml(p.uidDisplay)}</small></td>`;
      html += `<td>${escapeHtml(p.team || "-")}</td>`;

      // kills input only for kill games at runtime; here we show input but leave it to JS to enable logic
      const isSimple = SIMPLE_GAMES.some(g => matchGame.includes(g));
      html += `<td>${ isSimple ? '&mdash;' : `<input class="inputKills" type="number" value="${escapeHtml(String(p.kills))}" data-user="${escapeHtml(p.userId)}" min="0">` }</td>`;

      html += `<td>${ p.screenshotUrl ? `<img class="thumb" src="${escapeHtml(p.screenshotUrl)}" alt="screenshot">` : `<span class="small">No screenshot</span>` }</td>`;
      html += `<td class="small">${ p.uploadedAt ? escapeHtml(new Date(p.uploadedAt).toLocaleString()) : '-' }</td>`;
      html += `<td class="small">‚Çπ${escapeHtml(String(p.prize || 0))}</td>`;
      html += `</tr>`;
    });

    html += `</tbody></table>`;

    // controls
    html += `<div class="controls">`;
    html += `<div><label class="label small">Or select winner team:</label>`;
    html += `<label class="small"><input type="radio" name="team_${escapeHtml(String(match._id))}" value="LION" class="team-select"> LION</label>`;
    html += `<label class="small"><input type="radio" name="team_${escapeHtml(String(match._id))}" value="TIGER" class="team-select"> TIGER</label>`;
    html += `</div>`;
    html += `<div class="controls-right">`;
    html += `<button type="button" class="btn preview-btn" data-matchid="${escapeHtml(match._id)}" data-entryfee="${escapeHtml(String(Number(match.entryFee||0)))}" data-type="${escapeHtml(String(match.type||""))}" data-prizesystem="${escapeHtml(String(prizeSystem))}" data-game="${escapeHtml(String(match.game||""))}">Preview Payout</button>`;
    html += `<button type="button" class="btn complete-btn" data-matchid="${escapeHtml(match._id)}" data-type="${escapeHtml(String(match.type||""))}">Complete Match</button>`;
    html += `<button type="button" class="btn btn-danger delete-btn" data-matchid="${escapeHtml(match._id)}">Delete Match</button>`;
    html += `</div></div>`;
    html += `<div id="preview_${escapeHtml(match._id)}" class="resultPreview" style="display:none"></div>`;

    matchDiv.innerHTML = html;
    container.appendChild(matchDiv);
  });

  attachMatchHandlers();
}

/* ------------------ Attach handlers safely ------------------ */
function attachMatchHandlers(){
  // select-user buttons
  document.querySelectorAll(".select-user").forEach(btn=>{
    btn.removeEventListener("click", onSelectUser); // safe remove
    btn.addEventListener("click", onSelectUser);
  });

  // team radio selectors
  document.querySelectorAll(".team-select").forEach(radio=>{
    radio.removeEventListener("change", onSelectTeam);
    radio.addEventListener("change", onSelectTeam);
  });

  // preview buttons
  document.querySelectorAll(".preview-btn").forEach(btn=>{
    btn.removeEventListener("click", onPreview);
    btn.addEventListener("click", onPreview);
  });

  // complete buttons
  document.querySelectorAll(".complete-btn").forEach(btn=>{
    btn.removeEventListener("click", onComplete);
    btn.addEventListener("click", onComplete);
  });

  // delete buttons
  document.querySelectorAll(".delete-btn").forEach(btn=>{
    btn.removeEventListener("click", onDelete);
    btn.addEventListener("click", onDelete);
  });

  // thumbnails open modal
  document.querySelectorAll(".thumb").forEach(img=>{
    img.removeEventListener("click", onThumbClick);
    img.addEventListener("click", onThumbClick);
  });
}

function onSelectUser(e){
  const matchId = e.currentTarget.dataset.match;
  const userId = e.currentTarget.dataset.user;
  const name = e.currentTarget.dataset.name;
  selection[matchId] = { type: 'user', id: String(userId) };
  alert('Selected WINNER: ' + name);
}

function onSelectTeam(e){
  const name = e.currentTarget.name; // team_<matchId>
  const matchId = name.replace(/^team_/, '');
  const team = e.currentTarget.value;
  selection[matchId] = { type: 'team', id: team };
}

function onThumbClick(e){
  const src = e.currentTarget.getAttribute('src');
  if(src) openModal(src);
}

function onPreview(e){
  const btn = e.currentTarget;
  const matchId = btn.dataset.matchid;
  const entryFee = Number(btn.dataset.entryfee || 0);
  const matchType = btn.dataset.type || "";
  const serverPrizeSystem = btn.dataset.prizesystem || "";
  const game = btn.dataset.game || "";
  previewPayout(matchId, entryFee, matchType, serverPrizeSystem, game);
}

function onComplete(e){
  const btn = e.currentTarget;
  submitComplete(btn.dataset.matchid, btn.dataset.type);
}

function onDelete(e){
  const matchId = e.currentTarget.dataset.matchid;
  deleteMatch(matchId);
}

/* ------------------ Preview Payout ------------------ */
function previewPayout(matchId, entryFee, matchType, serverPrizeSystem, matchGameRaw){
  const previewBox = document.getElementById("preview_" + matchId);
  if(!previewBox) return;
  previewBox.style.display = "block";

  const rows = Array.from(document.querySelectorAll(`#match_${matchId} tbody tr`));
  const players = rows.map(r => {
    return {
      userId: r.dataset.userid,
      kills: Number(r.querySelector('.inputKills') ? r.querySelector('.inputKills').value || 0 : 0),
      name: r.children[1]?.innerText?.split("\n")[0].trim() || r.dataset.userid,
      team: r.children[2]?.innerText?.trim() || ""
    };
  });

  const totalPlayers = players.length || 1;
  const totalCollected = Number(entryFee) * totalPlayers;
  const adminCut = Math.round(totalCollected * 0.08);
  const prizePool = Math.max(0, totalCollected - adminCut);
  const overridePS = document.getElementById(`ps_${matchId}`)?.value;
  const prizeSystem = overridePS || serverPrizeSystem || "team_equal";

  const matchGame = (matchGameRaw || "").toLowerCase();
  const isSimple = SIMPLE_GAMES.some(g => matchGame.includes(g));
  const isKill = KILL_GAMES.some(g => matchGame.includes(g));

  const sel = selection[matchId] || null;
  let html = `<div style="padding:10px;background:#111;border-radius:8px">`;
  html += `<div><strong>Match:</strong> ${escapeHtml(matchGameRaw)}</div>`;
  html += `<div style="color:#9aa;font-size:13px">Players: ${totalPlayers} ‚Ä¢ Collected: ‚Çπ${totalCollected} ‚Ä¢ Admin cut (8%): ‚Çπ${adminCut}</div>`;
  html += `<div style="color:#9aa;font-size:13px">Prize system: ${escapeHtml(prizeSystem)}</div>`;
  html += `<hr style="border-color:#333;margin:8px 0">`;

  if(sel && sel.type === 'user'){
    const winner = players.find(p => String(p.userId) === String(sel.id));
    html += `<div><strong>Admin-selected winner</strong></div>`;
    html += `<div>Winner: <strong>${escapeHtml(winner ? winner.name : sel.id)}</strong></div>`;
    html += `<div style="margin-top:8px;font-size:16px"><strong>Winner receives: ‚Çπ${prizePool}</strong></div>`;
    html += `</div>`;
    previewBox.innerHTML = html;
    return;
  }

  if(isSimple){
    html += `<div><strong>Simple game detected (${escapeHtml(matchGameRaw)}).</strong></div>`;
    html += `<div class="small" style="margin-top:6px">Select a single player using WIN button. Winner receives full prize pool ‚Çπ${prizePool}.</div>`;
    html += `</div>`;
    previewBox.innerHTML = html;
    return;
  }

  // kill-games preview (1v1 or team)
  if(isKill){
    if((matchType || "").toLowerCase() === "1v1"){
      const sorted = [...players].sort((a,b)=>b.kills - a.kills);
      const top = sorted[0] || { name: '-', kills: 0 };
      html += `<div><strong>1v1 kill match</strong></div>`;
      html += `<div>Top player: <strong>${escapeHtml(top.name)}</strong> ‚Äî Kills: ${top.kills}</div>`;
      html += `<div style="margin-top:8px;font-size:16px"><strong>Payout: ‚Çπ${prizePool}</strong></div>`;
      html += `</div>`;
      previewBox.innerHTML = html;
      return;
    }

    // team preview
    if(selection[matchId] && selection[matchId].type === 'team'){
      const teamName = selection[matchId].id;
      const winners = players.filter(p => (p.team || "").toUpperCase() === String(teamName).toUpperCase());
      if(!winners.length){
        html += `<div style="color:var(--danger)">No players found for team ${escapeHtml(teamName)}. Backend will auto-assign if needed.</div></div>`;
        previewBox.innerHTML = html;
        return;
      }
      html += `<div><strong>Team winner:</strong> ${escapeHtml(teamName)}</div>`;
      html += `<div class="small" style="margin-bottom:8px">Prize system: <strong>${escapeHtml(prizeSystem)}</strong></div>`;
      if(prizeSystem === "team_equal"){
        const share = Math.round(prizePool / winners.length);
        html += `<table style="width:100%;border-collapse:collapse"><tr><th>Player</th><th>Kills</th><th>Share</th></tr>`;
        winners.forEach(p => html += `<tr><td>${escapeHtml(p.name)}</td><td>${p.kills}</td><td>‚Çπ${share}</td></tr>`);
        html += `</table>`;
        html += `<div style="margin-top:8px"><strong>Total awarded:</strong> ‚Çπ${share * winners.length}</div>`;
      } else {
        const totalKills = winners.reduce((s,p)=>s+p.kills,0);
        html += `<table style="width:100%;border-collapse:collapse"><tr><th>Player</th><th>Kills</th><th>Share</th></tr>`;
        winners.forEach(p => {
          const share = totalKills > 0 ? Math.round((p.kills / totalKills) * prizePool) : Math.round(prizePool / winners.length);
          html += `<tr><td>${escapeHtml(p.name)}</td><td>${p.kills}</td><td>‚Çπ${share}</td></tr>`;
        });
        html += `</table>`;
        html += `<div style="margin-top:8px"><strong>Prize pool:</strong> ‚Çπ${prizePool}</div>`;
      }
      html += `</div>`;
      previewBox.innerHTML = html;
      return;
    }

    html += `<div style="color:var(--muted)">Kill game detected. Select a team (LION/TIGER) or pick a single player as winner. For 1v1 supply kills in inputs.</div></div>`;
    previewBox.innerHTML = html;
    return;
  }

  // fallback message
  html += `<div style="color:var(--muted)">No winner selected. Choose a player with WIN button or select a team (LION/TIGER).</div></div>`;
  previewBox.innerHTML = html;
}

/* ------------------ Submit Complete ------------------ */
async function submitComplete(matchId, matchType){
  const rows = Array.from(document.querySelectorAll(`#match_${matchId} tbody tr`));
  const kills = rows.map(r => ({ userId: r.dataset.userid, kills: Number(r.querySelector('.inputKills')?.value || 0) }));
  const prizeSystem = document.getElementById(`ps_${matchId}`)?.value || "";
  const sel = selection[matchId] || null;

  if(!sel && (matchType || "").toLowerCase() !== "1v1"){
    alert("No winner chosen ‚Äî click WIN next to a player (single) or select a winning team (LION/TIGER).");
    return;
  }

  const winnerTeam = sel ? sel.id : null;
  if(!confirm("Are you sure you want to complete this match and issue payouts?")) return;

  try{
    showLoading(true);
    const res = await fetch(`${API_BASE}/admin/match/complete`, {
      method: "POST",
      headers: { "Content-Type":"application/json", "Authorization":"Bearer " + token },
      body: JSON.stringify({ matchId, winnerTeam, kills, prizeSystem: prizeSystem || undefined })
    });
    const data = await res.json();
    if(!data.success){
      alert(data.msg || "Server returned failure");
      console.error("Complete response:", data);
      return;
    }

    alert("Match completed ‚úÖ ‚Äî payouts: " + (data.payouts ? JSON.stringify(data.payouts) : data.payout || "see server response"));
    delete selection[matchId];
    loadMatches();
  }catch(err){
    console.error(err);
    alert("Network error while completing match");
  }finally{
    showLoading(false);
  }
}

/* ------------------ Delete Match ------------------ */
async function deleteMatch(matchId){
  if(!confirm("Permanently delete this match? This cannot be undone.")) return;
  try{
    showLoading(true);
    const r = await fetch(`${API_BASE}/admin/match/${matchId}`, { method:"DELETE", headers: { "Authorization":"Bearer " + token } });
    const data = await r.json();
    if(!data.success) alert(data.msg || "Delete failed");
    else { alert("Deleted"); loadMatches(); }
  }catch(err){
    console.error(err);
    alert("Network error while deleting match");
  }finally{ showLoading(false); }
}

/* ------------------ Init ------------------ */
loadMatches();
</script>
</body>
</html>
